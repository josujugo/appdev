<?xml version="1.0" encoding="iso-8859-1" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>16 EPICS General Purpose Tasks</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<!-- xhtml,2,html --> 
<meta name="src" content="AppDevGuide.tex" /> 
<meta name="date" content="2015-11-06 12:47:00" /> 
<link rel="stylesheet" type="text/css" href="AppDevGuide.css" /> 
</head><body 
>
<!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="AppDevGuidech17.html" >next</a>] [<a 
href="AppDevGuidech15.html" >prev</a>] [<a 
href="AppDevGuidech15.html#tailAppDevGuidech15.html" >prev-tail</a>] [<a 
href="#tailAppDevGuidech16.html">tail</a>] [<a 
href="AppDevGuide.html#AppDevGuidech16.html" >up</a>] </p></div>
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;16</span><br /><a 
 id="x18-69300016"></a>EPICS General Purpose Tasks</h2>
<h3 class="sectionHead"><span class="titlemark">16.1    </span> <a 
 id="x18-69400016.1"></a>Overview</h3>
<!--l. 5--><p class="noindent" >This chapter describes two sets of EPICS supplied general purpose tasks: 1) Callback, and 2) Task Watchdog.
</p><!--l. 7--><p class="noindent" >Often when writing code for an IOC there is no obvious task under which to execute. A good example is completion code for
an asynchronous device support module. EPICS supplies the callback tasks for such code.
</p><!--l. 10--><p class="noindent" >If an IOC tasks &#8220;crashes&#8221; there is normally no one monitoring the vxWorks shell to detect the problem. EPICS provides a task
watchdog task which periodically checks the state of other tasks. If it finds that a monitored task has terminated or suspended it
issues an error message and can also call other routines which can take additional actions. For example a subroutine record can
arrange to be put into alarm if a monitored task crashes.
</p><!--l. 15--><p class="noindent" >Since IOCs normally run autonomously, i.e. no one is monitoring the vxWorks shell, IOC code that issues <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">printf</span></span></span> calls
generates errors messages that are never seen. In addition the vxWorks implementation of fprintf requires much more stack
space then <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">printf</span></span></span> calls. Another problem with vxWorks is the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">logMsg</span></span></span> facility. <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">logMsg</span></span></span> generates messages at higher
priority then all other tasks except the shell. EPICS solves all of these problems via an error message handling facility.
Code can call any of the routines <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">errMessage</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">errPrintf</span></span></span>, or <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">errlogPrintf</span></span></span>. Any of these result in the
error message being generated by a separate low priority task. The calling task has to wait until the message is
handled but other tasks are not delayed. In addition the message can be sent to a system wide error message
file.
</p><!--l. 23--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">16.2    </span> <a 
 id="x18-69500016.2"></a>General Purpose Callback Tasks</h3>
<!--l. 26--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">16.2.1    </span> <a 
 id="x18-69600016.2.1"></a>Overview</h4>
<!--l. 28--><p class="noindent" >EPICS provides three sets of general purpose IOC callback tasks. The only difference between the task sets is their scheduling
priority: low, medium or high. The low priority tasks runs at a priority just higher than Channel Access, the medium priority
tasks at a priority about equal to the median of the periodic scan tasks, and the high priority tasks at a priority higher than the
event scan task. The callback tasks are available for any software component that needs a task under which to run some job
either immediately or after some delay. Jobs can also be cancelled during their delay period. The callback tasks register
themselves with the task watchdog (described below). They are created with a generous amount of stack space and can thus
be used for invoking record processing. For example the I/O event scanner uses the general purpose callback
tasks.
</p><!--l. 36--><p class="noindent" >The number of general purpose threads per priority level is configurable. On SMP systems with multi-core CPUs, the
throughput can be improved and the latency (time between job scheduling and processing) can be lowered by
running multiple parallel callback tasks, which the OS scheduler may assign to different CPU cores. Parallel
callback tasks must be explicitly enabled (see <a 
href="#x18-70000016.2.5">16.2.5<!--tex4ht:ref: Parallel Callback Tasks --></a> below), as this feature is disabled by default for compatibility
reasons.
</p><!--l. 39--><p class="noindent" >The following steps must be taken in order to use the general purpose callback tasks:
                                                                                         
                                                                                         
</p><!--l. 41--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x18-696002x1">Include callback definitions:
<a 
 id="dx18-696003"></a>
     <!--l. 45-->
          <div class="lstlisting" id="listing-287"><span class="label"><a 
 id="x18-696004r1"></a></span><span 
class="pcrb7t-">#</span><span 
class="pcrb7t-">include</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x003C;</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">h</span><span 
class="pcrr7t-">&#x003E;</span>
          
     </div>
     </li>
     <li 
  class="enumerate" id="x18-696006x2">Provide storage for a structure that is a private structure for the callback tasks:
<a 
 id="dx18-696007"></a>
     <!--l. 52-->
          <div class="lstlisting" id="listing-288"><span class="label"><a 
 id="x18-696008r1"></a></span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">mycallback</span><span 
class="pcrr7t-">;</span>
          
     </div>
     <!--l. 56--><p class="noindent" >It is permissible for this to be part of a larger structure, e.g.
</p>
     <!--l. 58-->
          <div class="lstlisting" id="listing-289"><span class="label"><a 
 id="x18-696009r1"></a></span><span 
class="pcrb7t-">struct</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696010r2"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696011r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">mycallback</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696012r4"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696013r5"></a></span><span 
class="pcrr7t-">}</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">...</span>
          
     </div>
     </li>
     <li 
  class="enumerate" id="x18-696015x3">Make calls (in most cases these are actually macros) to initialize the fields in the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">CALLBACK</span></span></span>:
<a 
 id="dx18-696016"></a>
     <!--l. 69-->
          <div class="lstlisting" id="listing-290"><span class="label"><a 
 id="x18-696017r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACKFUNC</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">func</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 73--><p class="noindent" >This defines the callback routine to be executed. The first argument is the address of a function that will be given the
     address of the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">CALLBACK</span></span></span> and returns <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">void</span></span></span>. The second argument is the address of the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">CALLBACK</span></span></span>
     structure.
<a 
 id="dx18-696018"></a>
</p>
     <!--l. 76-->
          <div class="lstlisting" id="listing-291"><span class="label"><a 
 id="x18-696019r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetPriority</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 80--><p class="noindent" >The first argument is the priority, which can have one of the values: <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">priorityLow</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">priorityMedium</span></span></span>, or
     <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">priorityHigh</span></span></span>. These values are defined in <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callback.h</span></span></span>. The second argument is again the address of the
     <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">CALLBACK</span></span></span> structure.
<a 
 id="dx18-696020"></a>
                                                                                         
                                                                                         
</p>
     <!--l. 85-->
          <div class="lstlisting" id="listing-292"><span class="label"><a 
 id="x18-696021r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 89--><p class="noindent" >This call is used to save a pointer value that can be retrieved again using the macro:
<a 
 id="dx18-696022"></a>
</p>
     <!--l. 92-->
          <div class="lstlisting" id="listing-293"><span class="label"><a 
 id="x18-696023r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackGetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;,</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 96--><p class="noindent" >If your callback function exists to process a single record inside calls to <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">dbScanLock</span></span></span>/<span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">dbScanUnlock</span></span></span>, you can use
     this shortcut which provides the callback routine for you and sets the other two parameters at the same time (the user
     parameter here is a pointer to the record instance):
<a 
 id="dx18-696024"></a>
</p>
     <!--l. 100-->
          <div class="lstlisting" id="listing-294"><span class="label"><a 
 id="x18-696025r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetProcess</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">prio</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">prec</span><span 
class="pcrr7t-">);</span>
          
     </div>
     </li>
     <li 
  class="enumerate" id="x18-696027x4">Whenever a callback request is desired just call one of the following:
<a 
 id="dx18-696028"></a>
<a 
 id="dx18-696029"></a>
     <!--l. 108-->
          <div class="lstlisting" id="listing-295"><span class="label"><a 
 id="x18-696030r1"></a></span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequest</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696031r2"></a></span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequestProcessCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcb</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">prio</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">prec</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 113--><p class="noindent" >Both can be called from interrupt level code. The callback routine is passed a single argument, which is the same
     argument that was passed to <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackRequest</span></span></span>, i.e., the address of the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">CALLBACK</span></span></span> structure. The second routine is a
     shortcut for calling both <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackSetProcess</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackRequest</span></span></span>. Both return zero in case of success, or an
     error code (see below).
     </p><!--l. 115--><p class="noindent" >The following delayed versions wait for the given time before queueing the callback routine for the relevant thread set to
     execute.
<a 
 id="dx18-696032"></a>
<a 
 id="dx18-696033"></a>
</p>
     <!--l. 119-->
          <div class="lstlisting" id="listing-296"><span class="label"><a 
 id="x18-696034r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequestDelayed</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">double</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">seconds</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696035r2"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequestProcessCallbackDelayed</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-696036r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Priority</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">double</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">seconds</span><span 
class="pcrr7t-">);</span>
          
                                                                                         
                                                                                         
     </div>
     <!--l. 125--><p class="noindent" >These routines cannot be called from interrupt level code.</p></li></ol>
<!--l. 128--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">16.2.2    </span> <a 
 id="x18-69700016.2.2"></a>Syntax</h4>
<!--l. 130--><p class="noindent" >The following calls are provided:
<a 
 id="dx18-697001"></a>
<a 
 id="dx18-697002"></a>
<a 
 id="dx18-697003"></a>
<a 
 id="dx18-697004"></a>
<a 
 id="dx18-697005"></a>
<a 
 id="dx18-697006"></a>
<a 
 id="dx18-697007"></a>
<a 
 id="dx18-697008"></a>
<a 
 id="dx18-697009"></a>
<a 
 id="dx18-697010"></a>
<a 
 id="dx18-697011"></a>
<a 
 id="dx18-697012"></a>
<a 
 id="dx18-697013"></a>
</p><!--l. 145--><p class="noindent" >Notes: </p><!--l. 146-->
     <div class="lstlisting" id="listing-297"><span class="label"><a 
 id="x18-697014r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackInit</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697015r2"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackShutdown</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697016r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697017r4"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallbackFunction</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697018r5"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697019r6"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetPriority</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">priority</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697020r7"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">user</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697021r8"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackGetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">user</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697022r9"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetProcess</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Priority</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">prec</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697023r10"></a></span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697024r11"></a></span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequest</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697025r12"></a></span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequestProcessCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697026r13"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Priority</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">prec</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697027r14"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequestDelayed</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">double</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">seconds</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697028r15"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequestProcessCallbackDelayed</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697029r16"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">Priority</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">prec</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">double</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">seconds</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697030r17"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackCancelDelayed</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697031r18"></a></span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetQueueSize</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">size</span><span 
class="pcrr7t-">);</span>
     
</div>
     <ul class="itemize1">
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackInit</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackShutdown</span></span></span> are performed automatically at IOC initialization or shutdown,
     thus user code never calls these functions.
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackSetCallback</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackSetPriority</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackSetUser</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackGetUser</span></span></span>
     are actually macros.
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">Both</span><span 
class="pcrr7t-">&#x00A0;callbackRequest</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackRequestProcessCallback</span></span></span> may be called from interrupt
     context. Both return zero for success, or one of the following error codes: <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">S_db_notInit</span></span></span> for a NULL callback
     pointer, <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">S_db_badChoice</span></span></span> for an illegal priority value, or <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">S_db_bufFull</span></span></span> when the associated queue is
     full.
     </li>
     <li class="itemize">The delayed versions of the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackRequest</span></span></span> routines wait the given time before queueing the callback.
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackCancelDelayed</span></span></span> can be used to cancel a delayed callback.
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackRequestProcessCallback</span></span></span> issues the calls:
     <!--l. 182-->
                                                                                         
                                                                                         
          <div class="lstlisting" id="listing-298"><span class="label"><a 
 id="x18-697032r1"></a></span><span 
class="pcrr7t-">callbackSetCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">ProcessCallback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697033r2"></a></span><span 
class="pcrr7t-">callbackSetPriority</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">Priority</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697034r3"></a></span><span 
class="pcrr7t-">callbackSetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697035r4"></a></span><span 
class="pcrr7t-">callbackRequest</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 189--><p class="noindent" >The routine <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">ProcessCallback</span></span></span> was designed for asynchronous device completion and is defined as:
</p>
     <!--l. 191-->
          <div class="lstlisting" id="listing-299"><span class="label"><a 
 id="x18-697036r1"></a></span><span 
class="pcrb7t-">static</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">ProcessCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697037r2"></a></span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697038r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">dbCommon</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697039r4"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">struct</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">rset</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">prset</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697040r5"></a></span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697041r6"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackGetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">pCallback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697042r7"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">prset</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">=</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">struct</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">rset</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;)</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">-&#x003E;</span><span 
class="pcrr7t-">rset</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697043r8"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">dbScanLock</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697044r9"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">prset</span><span 
class="pcrr7t-">-&#x003E;</span><span 
class="pcrr7t-">process</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697045r10"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">dbScanUnlock</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pRec</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-697046r11"></a></span><span 
class="pcrr7t-">}</span>
          
     </div>
     </li></ul>
<!--l. 207--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">16.2.3    </span> <a 
 id="x18-69800016.2.3"></a>Example</h4>
<!--l. 209--><p class="noindent" >An example use of the callback tasks.
</p>
<!--l. 211-->
     <div class="lstlisting" id="listing-300"><span class="label"><a 
 id="x18-698001r1"></a></span><span 
class="pcrb7t-">#</span><span 
class="pcrb7t-">include</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x003C;</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">h</span><span 
class="pcrr7t-">&#x003E;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698002r2"></a></span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698003r3"></a></span><span 
class="pcrb7t-">static</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">structure</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698004r4"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">char</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">begid</span><span 
class="pcrr7t-">[80];</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698005r5"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698006r6"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">char</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">endid</span><span 
class="pcrr7t-">[80];</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698007r7"></a></span><span 
class="pcrr7t-">}</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698008r8"></a></span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698009r9"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">myCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">CALLBACK</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698010r10"></a></span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698011r11"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">struct</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pmyStruct</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698012r12"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackGetUser</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">pmyStruct</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">pcallback</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698013r13"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">printf</span><span 
class="pcrr7t-">(</span><span 
class="pcrro7t-">"</span><span 
class="pcrro7t-">begid</span><span 
class="pcrro7t-">=%</span><span 
class="pcrro7t-">s</span><span 
class="pcrro7t-">&#x00A0;</span><span 
class="pcrro7t-">endid</span><span 
class="pcrro7t-">=%</span><span 
class="pcrro7t-">s</span><span 
class="pcrro7t-">\</span><span 
class="pcrro7t-">n</span><span 
class="pcrro7t-">"</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&amp;</span><span 
class="pcrr7t-">pmyStruct</span><span 
class="pcrr7t-">-&#x003E;</span><span 
class="pcrr7t-">begid</span><span 
class="pcrr7t-">[0],</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698014r14"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&amp;</span><span 
class="pcrr7t-">pmStruct</span><span 
class="pcrr7t-">-&#x003E;</span><span 
class="pcrr7t-">endid</span><span 
class="pcrr7t-">[0]);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698015r15"></a></span><span 
class="pcrr7t-">}</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698016r16"></a></span><span 
class="pcrr7t-">example</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">char</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pbegid</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">char</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">pendid</span><span 
class="pcrr7t-">)</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698017r17"></a></span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698018r18"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">strcpy</span><span 
class="pcrr7t-">(&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">begid</span><span 
class="pcrr7t-">[0],</span><span 
class="pcrr7t-">pbegid</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698019r19"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">strcpy</span><span 
class="pcrr7t-">(&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">endid</span><span 
class="pcrr7t-">[0],</span><span 
class="pcrr7t-">pendid</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698020r20"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetCallback</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">myCallback</span><span 
class="pcrr7t-">,&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698021r21"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetPriority</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">priorityLow</span><span 
class="pcrr7t-">,&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698022r22"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetUser</span><span 
class="pcrr7t-">(&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">,&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698023r23"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackRequest</span><span 
class="pcrr7t-">(&amp;</span><span 
class="pcrr7t-">myStruct</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-698024r24"></a></span><span 
class="pcrr7t-">}</span>
     
</div>
<!--l. 238--><p class="noindent" >The example can be tested by issuing the following command to the vxWorks shell:
                                                                                         
                                                                                         
</p>
<div class="verbatim" id="verbatim-217">
<div class="fancyvrb" id="fancyvrb217"><a 
 id="x18-698026r1"></a>&#x00A0;&#x00A0;example("begin","end")</div></div>
<!--l. 242--><p class="nopar" >
</p><!--l. 244--><p class="noindent" >This simple example shows how to use the callback tasks with your own structure that contains the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">CALLBACK</span></span></span> structure at an
arbitrary location.
</p><!--l. 247--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">16.2.4    </span> <a 
 id="x18-69900016.2.4"></a>Callback Queue</h4>
<!--l. 249--><p class="noindent" >The callback requests put the requests for each callback priority into a separate ring buffer. These buffers can by default hold up
to 2000 requests. This limit can be changed by calling <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackSetQueueSize</span></span></span> before <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">iocInit</span></span></span> in the startup file. The
syntax is:
<a 
 id="dx18-699001"></a>
</p>
<!--l. 254-->
     <div class="lstlisting" id="listing-301"><span class="label"><a 
 id="x18-699002r1"></a></span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callbackSetQueueSize</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">size</span><span 
class="pcrr7t-">)</span>
     
</div>
<!--l. 258--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">16.2.5    </span> <a 
 id="x18-70000016.2.5"></a>Parallel Callback Tasks</h4>
<!--l. 261--><p class="noindent" >To enable multiple parallel callback tasks, and set the number of tasks to be started for each priority level, call
<span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackParallelThreads</span></span></span> before <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">iocInit</span></span></span> in the startup file. The syntax is:
<a 
 id="dx18-700001"></a>
                                                                                         
                                                                                         
</p>
<div class="verbatim" id="verbatim-218">
<div class="fancyvrb" id="fancyvrb218"><a 
 id="x18-700003r1"></a>&#x00A0;&#x00A0;int&#x00A0;callbackParallelThreads(int&#x00A0;count,&#x00A0;const&#x00A0;char&#x00A0;&#x22C6;prio)</div></div>
<!--l. 267--><p class="nopar" >
</p><!--l. 269--><p class="noindent" >The count argument is the number of tasks to start, with 0 indicating to use the default (number of CPUs), and negative
numbers indicating to use the number of CPUs minus the specified amount.
</p><!--l. 271--><p class="noindent" >The prio argument specifies the priority level, with &#8221;&#8221; (empty string), &#8221;*&#8221;, or NULL indicating to apply the definition to all
priority levels.
</p><!--l. 273--><p class="noindent" >The default value is stored in the variable <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callbackParallelThreadsDefault</span></span></span> (initialized to the number of CPUs),
which can be changed using the iocShell&#8217;s <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">var</span></span></span> command.
</p><!--l. 275--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">16.3    </span> <a 
 id="x18-70100016.3"></a>Task Watchdog</h3>
<a 
 id="dx18-701001"></a>
<!--l. 279--><p class="noindent" >EPICS provides a task that acts as a watchdog for other tasks. Any task can request to be watched, and most of the IOC tasks do
this. A status monitoring subsystem in the IOC can register to be notified about any changes that occur. The watchdog task runs
periodically and checks each task in its task list. If any task is suspended, an error message is displayed and any notifications
made. The task watchdog provides the following features:
</p><!--l. 284--><p class="noindent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x18-701003x1">Include module:
<a 
 id="dx18-701004"></a>
     <!--l. 288-->
          <div class="lstlisting" id="listing-302"><span class="label"><a 
 id="x18-701005r1"></a></span><span 
class="pcrb7t-">#</span><span 
class="pcrb7t-">include</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x003C;</span><span 
class="pcrr7t-">taskwd</span><span 
class="pcrr7t-">.</span><span 
class="pcrr7t-">h</span><span 
class="pcrr7t-">&#x003E;</span>
          
     </div>
     </li>
     <li 
  class="enumerate" id="x18-701007x2">Request by a task to be monitored:
<a 
 id="dx18-701008"></a>
     <!--l. 295-->
          <div class="lstlisting" id="listing-303"><span class="label"><a 
 id="x18-701009r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdInsert</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">epicsThreadId</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tid</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">TASKWDFUNC</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">VOID</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 299--><p class="noindent" >This adds the task with the specified <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">tid</span></span></span> to the list of tasks to be watched, and makes any requested notifications that a
     new task has been registered. If <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">tid</span></span></span> is given as zero, the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">epicsThreadId</span></span></span> of the calling thread is used instead. If
     <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">callback</span></span></span> is not NULL and the task later becomes suspended, the callback routine will be called with the single
     argument <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">usr</span></span></span>.
                                                                                         
                                                                                         
     </p></li>
     <li 
  class="enumerate" id="x18-701011x3">Remove task from list:
<a 
 id="dx18-701012"></a>
     <!--l. 307-->
          <div class="lstlisting" id="listing-304"><span class="label"><a 
 id="x18-701013r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdRemove</span><span 
class="pcrr7t-">(</span><span 
class="pcrr7t-">epicsThreadId</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tid</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 311--><p class="noindent" >This routine must be called before the monitored task exits. It makes any requested notifications and removes the task
     from the list of tasks being watched. If <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">tid</span></span></span> is given as zero, the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">epicsThreadId</span></span></span> of the calling thread is used
     instead.
     </p></li>
     <li 
  class="enumerate" id="x18-701015x4">Request to be notified of changes:
<a 
 id="dx18-701016"></a>
<a 
 id="dx18-701017"></a>
     <!--l. 319-->
          <div class="lstlisting" id="listing-305"><span class="label"><a 
 id="x18-701018r1"></a></span><span 
class="pcrb7t-">typedef</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">struct</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">{</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-701019r2"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">(&#x22C6;</span><span 
class="pcrr7t-">insert</span><span 
class="pcrr7t-">)(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">epicsThreadId</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tid</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-701020r3"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">(&#x22C6;</span><span 
class="pcrr7t-">notify</span><span 
class="pcrr7t-">)(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">epicsThreadId</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tid</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">suspended</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-701021r4"></a></span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">(&#x22C6;</span><span 
class="pcrr7t-">remove</span><span 
class="pcrr7t-">)(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">epicsThreadId</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">tid</span><span 
class="pcrr7t-">);</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-701022r5"></a></span><span 
class="pcrr7t-">}</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdMonitor</span><span 
class="pcrr7t-">;</span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-701023r6"></a></span><span 
class="pcrr7t-">&#x00A0;</span><br /><span class="label"><a 
 id="x18-701024r7"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdMonitorAdd</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">const</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdMonitor</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">funcs</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 329--><p class="noindent" >This call provides a set of callbacks for the task watchdog to call when a task is registered or removed or when any
     task gets suspended. The <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">usr</span></span></span> pointer given at registration is passed to the callback routine along with
     the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">tid</span></span></span> of the thread the notification is about. In many cases the <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">insert</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">remove</span></span></span> callbacks will
     be called from the context of the thread itself, although this is not guaranteed (the registration could be
     made by a parent thread for instance). The <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">notify</span></span></span> callback also indicates whether the task went into or
     out of suspension; it is called in both cases, unlike the callbacks registered with <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">taskwdInsert</span></span></span> and
     <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">taskwdAnyInsert</span></span></span>.
     </p></li>
     <li 
  class="enumerate" id="x18-701026x5">Rescind notification request:
<a 
 id="dx18-701027"></a>
     <!--l. 339-->
          <div class="lstlisting" id="listing-306"><span class="label"><a 
 id="x18-701028r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdMonitorDel</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">const</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdMonitor</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">funcs</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 343--><p class="noindent" >This call removes a previously registered notification. Both <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">funcs</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">usr</span></span></span> must match the values given to
     <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">taskwdMonitorAdd</span></span></span> when originally registered.
     </p></li>
     <li 
  class="enumerate" id="x18-701030x6">Print a report:
<a 
 id="dx18-701031"></a>
     <!--l. 349-->
          <div class="lstlisting" id="listing-307"><span class="label"><a 
 id="x18-701032r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdShow</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">int</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">level</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 353--><p class="noindent" >If <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">level</span></span></span> is zero, the number of tasks and monitors registered is displayed. For higher values the registered task names
     and their current states are also shown in tabular form.
                                                                                         
                                                                                         
     </p></li>
     <li 
  class="enumerate" id="x18-701034x7">The following routines are provided for backwards compatibility purposes, but are now deprecated:
<a 
 id="dx18-701035"></a>
     <!--l. 359-->
          <div class="lstlisting" id="listing-308"><span class="label"><a 
 id="x18-701036r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdAnyInsert</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">key</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">TASKWDANYFUNC</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">callback</span><span 
class="pcrr7t-">,</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">VOID</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">usr</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 363--><p class="noindent" >The callback routine will be called whenever any of the tasks being monitored by the task watchdog become suspended.
     <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">key</span></span></span> must have a unique value because the task watchdog system uses this value to determine which entry to remove
     when <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">taskwdAnyRemove</span></span></span> is called.
<a 
 id="dx18-701037"></a>
</p>
     <!--l. 368-->
          <div class="lstlisting" id="listing-309"><span class="label"><a 
 id="x18-701038r1"></a></span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">taskwdAnyRemove</span><span 
class="pcrr7t-">(</span><span 
class="pcrb7t-">void</span><span 
class="pcrr7t-">&#x00A0;</span><span 
class="pcrr7t-">&#x22C6;</span><span 
class="pcrr7t-">key</span><span 
class="pcrr7t-">);</span>
          
     </div>
     <!--l. 372--><p class="noindent" ><span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">key</span></span></span> is the same value that was passed to <span class="obeylines-h"><span class="verb"><span 
class="pcrr7t-">taskwdAnyInsert</span></span></span>.</p></li></ol>
<!--l. 1--><div class="crosslinks"><p class="noindent">[<a 
href="AppDevGuidech17.html" >next</a>] [<a 
href="AppDevGuidech15.html" >prev</a>] [<a 
href="AppDevGuidech15.html#tailAppDevGuidech15.html" >prev-tail</a>] [<a 
href="AppDevGuidech16.html" >front</a>] [<a 
href="AppDevGuide.html#AppDevGuidech16.html" >up</a>] </p></div>
<!--l. 1--><p class="noindent" ><a 
 id="tailAppDevGuidech16.html"></a> </p> 
</body></html> 
